<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>The Blog of WoaW04</title><meta name="author" content="WoaW04"><meta name="copyright" content="WoaW04"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="The Blog of WoaW04">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="The Blog of WoaW04">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/WoaW04/Picture/image04CTF.png">
<meta property="article:author" content="WoaW04">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/WoaW04/Picture/image04CTF.png"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/WoaW04/Picture/image04CTF.png"><link rel="canonical" href="http://example.com/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'The Blog of WoaW04',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-10-26 23:20:32'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/WoaW04/Picture/image04CTF.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/WoaW04/Picture/image95796589_p0.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="The Blog of WoaW04"><img class="site-icon" src="https://cdn.jsdelivr.net/gh/WoaW04/Picture/image04CTF.png"/><span class="site-name">The Blog of WoaW04</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">The Blog of WoaW04</h1></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2024/10/26/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81easyre/" title="2024强网拟态easyre"><img class="post-bg" src="https://raw.githubusercontent.com/WoaW04/Picture/main/202410261308001.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024强网拟态easyre"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/10/26/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81easyre/" title="2024强网拟态easyre">2024强网拟态easyre</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-10-26T05:08:17.000Z" title="发表于 2024-10-26 13:08:17">2024-10-26</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/RE/">RE</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/">2024强网拟态</a></span></div><div class="content">0x00 前言纯动调，这玩意IDA看不了一点
因为用了iTruth版本的x64dbg，整合了不少插件（好多不知道啥用的）所以
听说有反调试？无駄！
0x01 解IDA看不了一点（好像是ollvm），上x64dbg一步步调
从输入下手，运行直到要求输入然后暂停，随便输点东西就会停下在syscall后面，回到用户空间后一步步ret回去，直到找到类似scanf参数的地方

之后一步步调，同时开启追踪记录，字节为单位，重点查看访问多次的内容，注意因为有大量花指令的存在，所以一定要用步进而不是步过来调，要不然随便哪个带call的花就会退出

首先可以发现这里调用了输入的内容

之后进了一个函数（其他花指令的call都是很近的，但是这个call跳转地址很远）

根据返回的值可以知道这是获取输入长度的（可能是strlen？）

继续跟踪发现这里被调用了三次之多，下个断点重启程序看看

重新执行直到调用strlen，然后看看输入长度被存到了哪里
发现存到了下面两个地址里面

下个两个硬断看看啥时候调用
发现丢到rdx里面去了

跟下去，发现rdx被拿去作比较了

估计这就是flag的长度了，试试发现确 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/10/25/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81A-game/" title="2024强网拟态A_game"><img class="post-bg" src="https://raw.githubusercontent.com/WoaW04/Picture/main/202410251026625.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024强网拟态A_game"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/10/25/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81A-game/" title="2024强网拟态A_game">2024强网拟态A_game</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-10-25T02:22:54.000Z" title="发表于 2024-10-25 10:22:54">2024-10-25</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/RE/">RE</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/">2024强网拟态</a></span></div><div class="content">0x00 前言游戏题，主要学学游戏题应该怎么做，以前碰到游戏题都在misc或者压根没做出来（然后没WP）
拿到这题是懵的，没有符号就算了，压根不知道该干什么
兜兜转转搜到了源码PacManX，本来想着有源码自行编译之后拿去BinDiff一下，但是自行编译很多环境是不一样的，所以不行
通过搜索字符串，查找一局游戏结束时的操作，发现也没有特别的，这时候就卡住了
后面查看WP发现原来是放在了读文件的操作上，看到游戏确实有给多四个文件，看来以后做游戏题还得注意文件读写这块（毕竟有存档之类的，这些东西也是可以藏数据的）
0x01 解无壳，64位，直接上IDA
想直接动调，但是有反调试
通过在import表搜索exit可以找到不少相关调用，一个个看，最后发现在高亮处这个地方很怪

F5一下可以看到对两个字符串进行了判断

这边这个反调试是这样的：
1.用函数CreateToolhelp32Snapshot，参数dwFlags=2，th32ProcessID=0，返回值给到变量hSnapshot
2.创建一个PROCESSENTRY32W结构的变量pe，其中dwSize=568
3.调用函数Proc ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/10/24/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81babyre/" title="2024强网拟态babyre"><img class="post-bg" src="https://raw.githubusercontent.com/WoaW04/Picture/main/202410241743302.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024强网拟态babyre"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/10/24/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81babyre/" title="2024强网拟态babyre">2024强网拟态babyre</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-10-24T09:42:46.000Z" title="发表于 2024-10-24 17:42:46">2024-10-24</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/RE/">RE</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/">2024强网拟态</a></span></div><div class="content">0x00 前言试试爆破和klee两种方法
0x01 解分析无壳，64位，直接上IDA

还算简洁，就是注意输入中间每隔几位就要用-隔开，要不然读不到
先看看sub_401550

AES，没啥好说的，sub_401BCE是轮密钥加，sub_4016FD是字节代换，sub_4017C5是行移位，sub_40197E是列混合
可以在字节代换里面找到S盒，流程是标准的AES流程，没魔改，解密时可以直接解密
key是调用AES时的第二个参数unk_405420，共16Bytes
10x35, 0x77, 0x40, 0x2E, 0xCC, 0xA4, 0x4A, 0x3F, 0x9A, 0xB7, 0x21, 0x82, 0xF9, 0xB0, 0x1F, 0x35

之后才是重量级
AES的加密结果丢进了这个函数，a2就是丢进来的值，a1就是转换结果

分析了一下，a1总共16*12Bytes长，每12Bytes为一个单元，一个单元分为两个部分，第一个部分为a1[11]a1[8]，分别存入1或0，应该是序号，最多为15（即F），而第二部分为a1[7]a1[0]，存入的是a2的内容，一个一个位 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/10/14/2024%E5%8D%8E%E4%B8%BA%E6%9D%AFezhtml/" title="2024华为杯ezhtml">2024华为杯ezhtml</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-10-14T06:00:18.000Z" title="发表于 2024-10-14 14:00:18">2024-10-14</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/RE/">RE</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/2024%E5%8D%8E%E4%B8%BA%E6%9D%AF/">2024华为杯</a></span></div><div class="content">0x00 前言借机学学wasm逆向
0x01 解直接将.wasm文件拖入JEB（安卓逆向用的那个），选择wasmbc

直接去main函数，找到调用了函数f7

双击进去右键反编译

还算清晰，就是一个循环异或，最后一位明文由第一位密文加密，密文就在&amp;aEBPGRM_VER9B_Q5S里面
附个脚本
1234567enc = &#x27;EBPGRM|VE9B]Q5Sb4vJ^2|ZoU[t?SiDf9Cx&#x27;enc=list(enc)flag = &#x27;&#x27;for i in range(len(enc)-1,-1,-1):    enc[i]=chr(ord(enc[i]) ^ (ord(enc[(i+1)%len(enc)]) &amp; 0xf))print(&#x27;&#x27;.join(enc))# DASCTF&#123;WA4M_R3Ve7sE_1s_eZ_t0_lEa7N&#125;

真不难，但是没做过所以一窍不通，借此也是学习了JEB在解析wasm的用处了，比搜到的又是编译又是头文件的简单很多
后面查到还有IDA解析wasm的项目， ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/10/13/2024%E5%8D%8E%E4%B8%BA%E6%9D%AFdowncity/" title="2024华为杯downcity">2024华为杯downcity</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-10-13T08:52:44.000Z" title="发表于 2024-10-13 16:52:44">2024-10-13</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/RE/">RE</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/2024%E5%8D%8E%E4%B8%BA%E6%9D%AF/">2024华为杯</a></span></div><div class="content">0x00 前言纯VM，朝花夕拾
0x01 解无壳，直接进main函数

这么清晰？直接解了看看

我就知道.jpg
main下面有一大堆vm

可以发现是非常标准的VM


经过重设变量类型（a1应为_DWORD *）和一些分析，可以得出各变量的含义：
1234//a1 = memory//a1[0] = eip//a1[502] = stack bottom//a1[501] = stack pointer

然后在vm_init里面可以找到opcode

直接写解释器看看各条命令，这里的opcode是以4bytes为单位，其中第一个byte为操作码，后面的是立即数之类的东西
我直接一个拆分，一个字节一个字节读，所以我的eip的加加要加4，某些大的立即数也要从后往前读（小端），同时由于第一个值是eip，我也是自己搞一个来，所以有些地址操作要变，当然里面所有的立即数之类的，特别是放进去的地址后面写的时候也要做变换（后面会有注释）
1234567891011121314151617181920212223242526272829303132333435363738394041424344 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/10/12/2024%E5%8D%8E%E4%B8%BA%E6%9D%AFdetou4/" title="2024华为杯detou4">2024华为杯detou4</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-10-12T04:35:26.000Z" title="发表于 2024-10-12 12:35:26">2024-10-12</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/RE/">RE</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/2024%E5%8D%8E%E4%B8%BA%E6%9D%AF/">2024华为杯</a></span></div><div class="content">0x00 前言detours库的应用
有TLS反调试，不过不清楚怎么执行的
迷惑性很强
0x01 解无壳，直接拖IDA

比较清晰，首先是一个key，key长为16Bytes，然后才是flag的输入
先解key，进去发现是这样的
1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253v13[0] = 0x728C;v13[1] = 0x5A38;v13[2] = 0x767A;v13[3] = 0x6AB9;v13[4] = 0x6BAD;v13[5] = 0x52D6;v13[6] = 0x6ECF;v13[7] = 0x68CF;v13[8] = 0x5469;v13[9] = 0x408B;v13[10] = 0x58E3;v13[11] = 0x4E1D;v13[12] = 0x791F;v13[13] = 0x5FC9;v13[14] = 0x78F2;v13[15] = 0x79CD;v7 = operator new(0x48u);v ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/10/08/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF%E2%80%94%E2%80%94Frida/" title="安卓逆向学习之路——Frida">安卓逆向学习之路——Frida</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-10-08T08:22:03.000Z" title="发表于 2024-10-08 16:22:03">2024-10-08</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/RE/">RE</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/">安卓逆向</a></span></div><div class="content">0x00 前言一直都知道Frida是一个非常强大的Hook框架，而且其Hook对象不仅限于安卓，连Windows应用的Hook他都可以搞定
然而受限于对JavaScript的不熟悉，一直拖着没有系统学习
借着《吾爱破解安卓逆向入门教程》提供的模板和介绍、对JS语言的相关语法的查阅以及利用其它框架的经验
还是系统地学学Frida比较好
参考：
《安卓逆向这档事》十三、是时候学习一下Frida一把梭了(上)
《安卓逆向这档事》十四、是时候学习一下Frida一把梭了(中)
《安卓逆向这档事》十五、是时候学习一下Frida一把梭了(下)
《安卓逆向这档事》十六、是时候学习一下Frida一把梭了(终)
0x01 Frida基础知识Frida是一款开源的动态插桩工具，可以插入一些代码到原生App的内存空间去动态地监视和修改其行为，支持Windows、Mac、Linux、Android或者iOS，从安卓层面来讲，可以实现Java层和Native层Hook操作。
Frida的安装非常简单，不指定版本的话用pip就行（我的版本为16.4.3）
1pip install frida-tools

之后再把 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/10/01/QilingLab-%E4%B8%8A%E6%89%8BQilingFramework/" title="QilingLab-上手QilingFramework"><img class="post-bg" src="https://raw.githubusercontent.com/WoaW04/Picture/main/202410010015849.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="QilingLab-上手QilingFramework"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/10/01/QilingLab-%E4%B8%8A%E6%89%8BQilingFramework/" title="QilingLab-上手QilingFramework">QilingLab-上手QilingFramework</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-30T16:13:19.000Z" title="发表于 2024-10-01 00:13:19">2024-10-01</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/RE/">RE</a></span></div><div class="content">0x00 前言第一次接触模拟执行这个东西，从QilingFramework开始上手试试看，后面还要学Qemu、Unicorn、Unidbg等
0x01 解使用
1git clone https://github.com/qilingframework/qiling.git --recursiv

克隆整个仓库
由于x86_64和aarch64题目内容，而我使用的是x86_64平台，因此为了体现模拟执行的强大，以下都使用aarch64的文件来解
之后使用模板如下
12345678910111213# 模板如下：from qiling import *from qiling.const import QL_VERBOSEdef challenge1(ql: Qiling):    passif __name__  == &#x27;__main__&#x27;:    path = [&#x27;qilinglab/qilinglab-aarch64&#x27;] # lab目标    rootfs = &quot;./examples/rootfs/arm64_linux&quot; # ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/09/18/2024%E7%BE%8A%E5%9F%8E%E6%9D%AFchal/" title="2024羊城杯chal"><img class="post-bg" src="https://raw.githubusercontent.com/WoaW04/Picture/main/202409182255885.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024羊城杯chal"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/09/18/2024%E7%BE%8A%E5%9F%8E%E6%9D%AFchal/" title="2024羊城杯chal">2024羊城杯chal</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-18T13:31:45.000Z" title="发表于 2024-09-18 21:31:45">2024-09-18</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/RE/">RE</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/2024%E7%BE%8A%E5%9F%8E%E6%9D%AF/">2024羊城杯</a></span></div><div class="content">0x00 前言Cython逆向，借机学一下：Cython 二进制库逆向分析全面指南
WP来自2024年羊城杯粤港澳大湾区网络安全大赛WP-Reverse篇（全网唯一chal题解的含金量）
本体对环境有要求，一定要是linux+python3.12的环境
0x01 解根据给出的main.py，可以知道chal里面有个chal
1234import chalflag = input(&quot;flag: &quot;)chal.chal(flag)

开启python，导入一下chal库然后打印一下属性
1234567891011121314151617181920212223Python 3.12.5 | packaged by Anaconda, Inc. | (main, Sep 12 2024, 18:27:27) [GCC 11.2.0] on linuxType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.&gt ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/09/17/2024%E7%BE%8A%E5%9F%8E%E6%9D%AF%E4%BD%A0%E8%BF%99%E4%B8%BB%E5%87%BD%E6%95%B0%E4%BF%9D%E7%9C%9F%E4%B9%88/" title="2024羊城杯你这主函数保真么"><img class="post-bg" src="https://raw.githubusercontent.com/WoaW04/Picture/main/202409171702467.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024羊城杯你这主函数保真么"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/09/17/2024%E7%BE%8A%E5%9F%8E%E6%9D%AF%E4%BD%A0%E8%BF%99%E4%B8%BB%E5%87%BD%E6%95%B0%E4%BF%9D%E7%9C%9F%E4%B9%88/" title="2024羊城杯你这主函数保真么">2024羊城杯你这主函数保真么</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-17T08:55:52.000Z" title="发表于 2024-09-17 16:55:52">2024-09-17</time></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/RE/">RE</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/2024%E7%BE%8A%E5%9F%8E%E6%9D%AF/">2024羊城杯</a></span></div><div class="content">0x00 前言构造函数当主逻辑，第一次见
0x01 解无壳，直接拖IDA
搜main可以发现有两个main，一个是_main还有一个是___main

查引用发现___main在_main之前调用

两个函数都没什么东西
_main

___main

不过发现___main有一个跳转，进去之后可以看到有个函数指针

动调发现这个是从下往上调用的
调试，直到有flag字样的函数出现，步入，发现调用了读起来像是构造和析构函数的东西，

继续跟进，发现两个test对象

一个个看，test是主逻辑，读字符串并进行长度判断，由此可知flag长度为0x21

再看test2，发现是个ROT13，应该直接调的库，没有魔改

之后继续跟进，发现在___tcf3内还有东西

这里面是Test2类的析构函数，而析构函数里面调用了输入在ROT13操作后的结果

之后可以看到一个encrypt函数

进去发现又是一段加密，用到了一些三角函数，经查询这是DCT变换

之后发现加密的结果丢到了这个变量_encrypted里面

既然Test2类的析构函数有搞事情，那么Test估计也有

这边F5一下可以看到清 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/#content-inner">6</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/WoaW04/Picture/image04CTF.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">WoaW04</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/WoaW04"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/RE/" style="font-size: 1.45em; color: rgb(87, 157, 116)">RE</a><a href="/tags/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/" style="font-size: 1.27em; color: rgb(150, 177, 84)">腾讯游戏安全竞赛</a><a href="/tags/2023DASCTFxBCCTF/" style="font-size: 1.21em; color: rgb(184, 136, 78)">2023DASCTFxBCCTF</a><a href="/tags/2023DASCTF%E4%B8%83%E6%9C%88%E8%B5%9B/" style="font-size: 1.27em; color: rgb(64, 188, 131)">2023DASCTF七月赛</a><a href="/tags/2023NepCTF/" style="font-size: 1.21em; color: rgb(37, 66, 178)">2023NepCTF</a><a href="/tags/2023starCTF/" style="font-size: 1.27em; color: rgb(129, 49, 112)">2023starCTF</a><a href="/tags/2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9B/" style="font-size: 1.27em; color: rgb(19, 168, 106)">2023年春秋杯网络安全联赛冬季赛</a><a href="/tags/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/" style="font-size: 1.21em; color: rgb(0, 195, 38)">巅峰极客2023</a><a href="/tags/2023%E7%BE%8A%E5%9F%8E%E6%9D%AF/" style="font-size: 1.33em; color: rgb(167, 58, 129)">2023羊城杯</a><a href="/tags/2024CISCN/" style="font-size: 1.27em; color: rgb(100, 134, 132)">2024CISCN</a><a href="/tags/2024DASCTFXHDCTF/" style="font-size: 1.21em; color: rgb(36, 21, 39)">2024DASCTFXHDCTF</a><a href="/tags/2024NKCTF/" style="font-size: 1.27em; color: rgb(4, 27, 68)">2024NKCTF</a><a href="/tags/2024RCTF/" style="font-size: 1.15em; color: rgb(123, 154, 32)">2024RCTF</a><a href="/tags/2024%E5%8D%8E%E4%B8%BA%E6%9D%AF/" style="font-size: 1.27em; color: rgb(104, 123, 54)">2024华为杯</a><a href="/tags/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/" style="font-size: 1.27em; color: rgb(7, 76, 193)">2024强网拟态</a><a href="/tags/2024%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%A4%8F%E5%AD%A3%E8%B5%9B/" style="font-size: 1.27em; color: rgb(140, 20, 137)">2024春秋杯网络安全联赛夏季赛</a><a href="/tags/2024%E7%BE%8A%E5%9F%8E%E6%9D%AF/" style="font-size: 1.39em; color: rgb(190, 141, 78)">2024羊城杯</a><a href="/tags/DASCTF-X-GFCTF-2024/" style="font-size: 1.27em; color: rgb(178, 88, 139)">DASCTF X GFCTF 2024</a><a href="/tags/Learning/" style="font-size: 1.21em; color: rgb(187, 133, 68)">Learning</a><a href="/tags/Misc/" style="font-size: 1.15em; color: rgb(60, 131, 169)">Misc</a><a href="/tags/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/" style="font-size: 1.21em; color: rgb(110, 117, 150)">安卓逆向</a><a href="/tags/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8/" style="font-size: 1.15em; color: rgb(182, 59, 178)">软件安全</a></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">57</div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-10-26T15:20:32.725Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background: #FFFFFF00"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By WoaW04</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div></div></body></html>